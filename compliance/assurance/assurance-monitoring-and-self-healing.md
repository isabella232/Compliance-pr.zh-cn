---
title: Microsoft 365 中的数据监视和自修复
description: 本文将介绍 Microsoft 365 的监视和自我修复功能。
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
f1.keywords:
- NOCSH
ms.custom:
- seo-marvel-apr2020
titleSuffix: Microsoft Service Assurance
hideEdit: true
ms.openlocfilehash: baf73746fff5e4866c36975e082c84017e0b3083
ms.sourcegitcommit: 024137a15ab23d26cac5ec14c36f3577fd8a0cc4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/01/2021
ms.locfileid: "51496941"
---
# <a name="data-monitoring-and-self-healing-in-microsoft-365"></a><span data-ttu-id="7bf0a-103">Microsoft 365 中的数据监视和自修复</span><span class="sxs-lookup"><span data-stu-id="7bf0a-103">Data monitoring and self-healing in Microsoft 365</span></span>

<span data-ttu-id="7bf0a-104">鉴于 Microsoft 365 的规模，如果不进行全面的内置监视、智能警报和快速可靠的自我修复，则不可能保持客户数据的复原和安全免受恶意软件的攻击。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-104">Given the scale of Microsoft 365, it would be impossible to keep customer data resilient and safe from malware without built-in monitoring that is comprehensive, alerting that is intelligent, and self-healing that is fast and reliable.</span></span> <span data-ttu-id="7bf0a-105">在 Microsoft 365 规模上监视一组服务非常具有挑战性。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-105">Monitoring a set of services at the scale of Microsoft 365 is very challenging.</span></span> <span data-ttu-id="7bf0a-106">需要引入新的意识和方法，需要创建全新的技术集才能在连接的全球环境中运行和管理服务。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-106">New mindsets and methodologies needed to be introduced, and whole new sets of technology needed to be created to operate and manage the service in a connected global environment.</span></span> <span data-ttu-id="7bf0a-107">我们已从数据收集和筛选的传统监视方法移到基于数据分析的方法创建警报;接收信号并置信于该数据，然后使用自动化恢复或解决问题。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-107">We have moved away from the traditional monitoring approach of data collection and filtering to create alerts to an approach that is based on data analysis; taking signals and building confidence in that data and then using automation to recover or resolve the issue.</span></span> <span data-ttu-id="7bf0a-108">此方法有助于使人员从恢复公式中退出，这反过来会使操作成本更低、速度更快且容易出错。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-108">This approach helps take humans out of the recovery equation, which in turn makes operations less expensive, faster, and less error prone.</span></span> 

<span data-ttu-id="7bf0a-109">Microsoft 365 监视的基础是组成 Data Insights 引擎的技术集合，该引擎基于 Azure、SQL Azure 和开源流式处理数据库 [技术构建](https://cassandra.apache.org/)。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-109">Fundamental to Microsoft 365 monitoring is a collection of technologies that comprise our Data Insights Engine, which is built on Azure, SQL Azure, and [open-source streaming database technology](https://cassandra.apache.org/).</span></span> <span data-ttu-id="7bf0a-110">它旨在收集和汇总数据并得出结论。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-110">It is designed to collect and aggregate data and reach conclusions.</span></span> <span data-ttu-id="7bf0a-111">目前，它每小时处理超过 5 亿个事件，从每天 100，000 多台服务器 (~15 TB) 分散在许多区域的数十个数据中心，并且这些数字不断增加。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-111">Currently, it processes more than 500 million events per hour from more than 100,000 servers (~15 TB per day) scattered across dozens of datacenters in many regions, and these numbers are growing.</span></span> 

<span data-ttu-id="7bf0a-112">Microsoft 365 使用 *外部监视*，其中包括创建综合事务来测试所有重要的内容。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-112">Microsoft 365 uses *outside-in monitoring*, which involves creating synthetic transactions to test everything that is important.</span></span> <span data-ttu-id="7bf0a-113">例如，在 Exchange Online 中，每个方案都以分散方式每五分钟测试一次全球每个数据库，从而提供系统中所有内容近乎连续的覆盖。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-113">For example, in Exchange Online each scenario is testing every database worldwide every five minutes in a scattered fashion, providing near continuous coverage of everything that lives in the system.</span></span> <span data-ttu-id="7bf0a-114">从多个位置执行每天 2.5 亿个测试事务，为服务创建可靠的基线或检测信号。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-114">From multiple locations, 250 million test transactions per day are performed to create a robust baseline or heartbeat for the service.</span></span> 

<span data-ttu-id="7bf0a-115">Microsoft 365 还使用红色警报的概念，该概念将来自我们数据中心中所有计算机的所有监视信号缩减为可人工管理的信号。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-115">Microsoft 365 also uses the concept of *Red Alert*, which shrinks down all the monitoring signals from all of the machines in our datacenters to something manageable by a human being.</span></span> <span data-ttu-id="7bf0a-116">概念非常简单：如果多个信号中发生某些情况，则必须发生一些事件。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-116">The concept is quite simple: If something is happening across multiple signals, there must be something going on.</span></span> <span data-ttu-id="7bf0a-117">不是为了在一个信号中建立置信度，而只是让每个信号具有合理的保真度，以便获得更高的准确性。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-117">It is not about building confidence in one signal, it is about having reasonable fidelity for each signal so that you get greater accuracy.</span></span> <span data-ttu-id="7bf0a-118">此监视系统功能强大，因此没有 24x7 工作人员在监视监视器;我们只有一个在检测到问题时唤醒的机子，在这种情况下，它将分页相应的呼叫人员，或者更像现在一样，它会继续操作并解决问题。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-118">This monitoring system is so powerful that we do not have 24x7 staff watching our monitors; all we have is the machinery that wakes up if it detects a problem, in which case it will page the appropriate on-call personnel, or more often as is the case, it will just go ahead and solve the problem.</span></span> <span data-ttu-id="7bf0a-119">开始收集信号并生成红色警报后，我们可以开始跨所有服务分区进行三角分析。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-119">Once we start collecting signals and building red alerts off them, we can start triangulating across all our service partitions.</span></span> 

<span data-ttu-id="7bf0a-120">根据故障警报和红色警报的组合，此警报准确指示哪些组件可能存在问题，并且系统将尝试通过重新启动邮箱服务器自行纠正该问题。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-120">Based on the combination of the failure alert and the Red Alerts, this alert indicates exactly which components could be having a problem, and that the system is going to try to correct the problem by itself by restarting a mailbox server.</span></span> 

<span data-ttu-id="7bf0a-121">除了可自行修复的功能（如单页还原）之外，Exchange Online 还包括一些功能，这些功能采用监视和自我修复的方法，侧重于保留最终用户体验。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-121">In addition to self-healing capabilities such as single page restore, Exchange Online includes several features that take an approach to monitoring and self-healing which focuses on preserving the end-user experience.</span></span> <span data-ttu-id="7bf0a-122">这些功能包括 *托管可用性（* 提供内置的监视和恢复操作）和 AutoReseed（在磁盘故障后自动还原数据库冗余）。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-122">These features include *Managed Availability*, which provides built-in monitoring and recovery actions, and AutoReseed, which automatically restores database redundancy after a disk failure.</span></span> 

## <a name="managed-availability"></a><span data-ttu-id="7bf0a-123">托管可用性</span><span class="sxs-lookup"><span data-stu-id="7bf0a-123">Managed Availability</span></span> 

<span data-ttu-id="7bf0a-124">托管可用性提供本机运行状况检查和恢复解决方案，通过面向恢复的操作监视和保护最终用户的体验。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-124">Managed availability provides a native health checking and recovery solution that monitors and protects the end user's experience through recovery-oriented actions.</span></span> <span data-ttu-id="7bf0a-125">托管可用性是内置监视和恢复操作与 Exchange 高可用性平台的集成。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-125">Managed availability is the integration of built-in monitoring and recovery actions with the Exchange high availability platform.</span></span> <span data-ttu-id="7bf0a-126">它设计用于在问题出现后立即被系统检测到以检测并恢复。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-126">It's designed to detect and recover from problems as soon as they occur and are discovered by the system.</span></span> <span data-ttu-id="7bf0a-127">与 Exchange 之前的外部监视解决方案和技术不同的是，托管可用性不会尝试识别或沟通问题的根本原因。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-127">Unlike previous external monitoring solutions and techniques for Exchange, managed availability doesn't try to identify or communicate the root cause of an issue.</span></span> <span data-ttu-id="7bf0a-128">相反，它侧重于解决最终用户体验的三个关键方面的恢复方面：</span><span class="sxs-lookup"><span data-stu-id="7bf0a-128">Instead, it's focused on recovery aspects that address three key areas of the end-user experience:</span></span>

- <span data-ttu-id="7bf0a-129">**可用性** - 用户能否访问服务？</span><span class="sxs-lookup"><span data-stu-id="7bf0a-129">**Availability** - Can users access the service?</span></span> 
- <span data-ttu-id="7bf0a-130">**延迟** - 用户体验如何？</span><span class="sxs-lookup"><span data-stu-id="7bf0a-130">**Latency** - How is the experience for users?</span></span> 
- <span data-ttu-id="7bf0a-131">**错误** - 用户能否完成所需的操作？</span><span class="sxs-lookup"><span data-stu-id="7bf0a-131">**Errors** - Are users able to accomplish what they want?</span></span> 

<span data-ttu-id="7bf0a-132">托管可用性是一项内部功能，在运行 Exchange Online 的每一台 Microsoft 365 服务器上运行。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-132">Managed availability is an internal feature that runs on every Microsoft 365 server running Exchange Online.</span></span> <span data-ttu-id="7bf0a-133">它每秒轮询和分析数百个运行状况度量。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-133">It polls and analyzes hundreds of health metrics every second.</span></span> <span data-ttu-id="7bf0a-134">如果发现错误，大多数情况下会自动修复错误。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-134">If something is found to be wrong, most of the time it is fixed automatically.</span></span> <span data-ttu-id="7bf0a-135">但始终存在托管可用性无法自行修复的问题。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-135">But there will always be issues that managed availability will not be able to fix on its own.</span></span> <span data-ttu-id="7bf0a-136">在这种情况下，托管可用性会通过事件日志记录将问题上报给 Microsoft 365 支持团队。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-136">In those cases, managed availability will escalate the issue to a Microsoft 365 support team by means of event logging.</span></span>

## <a name="autoreseed"></a><span data-ttu-id="7bf0a-137">自动种子重新设定</span><span class="sxs-lookup"><span data-stu-id="7bf0a-137">AutoReseed</span></span>

<span data-ttu-id="7bf0a-138">Exchange Online 服务器部署在一个配置中，该配置将多个数据库及其日志流存储在同一个非 RAID 磁盘上。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-138">Exchange Online servers are deployed in a configuration that stores multiple databases and their log streams on the same non-RAID disk.</span></span> <span data-ttu-id="7bf0a-139">此配置通常只称为一 *批磁盘* (JBOD) 因为没有使用存储冗余机制（如 RAID）来复制磁盘上的数据。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-139">This configuration is often referred to as *just a bunch of disks* (JBOD) because no storage redundancy mechanisms, such as RAID, are being used to duplicate the data on the disk.</span></span> <span data-ttu-id="7bf0a-140">当磁盘在 JBOD 环境中出现故障时，该磁盘上的数据将丢失。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-140">When a disk fails in a JBOD environment, the data on that disk is lost.</span></span> 

<span data-ttu-id="7bf0a-141">鉴于 Exchange Online 的大小以及内部部署的磁盘驱动器数百万个，磁盘驱动器故障在 Exchange Online 中经常发生。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-141">Given the size of Exchange Online and the fact that deployed within it are millions of disk drives, disk drive failures are a regular occurrence in Exchange Online.</span></span> <span data-ttu-id="7bf0a-142">事实上，每天超过 100 次失败。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-142">In fact, more than 100 fail every day.</span></span> <span data-ttu-id="7bf0a-143">当本地企业部署中的磁盘出现故障时，管理员必须手动更换故障磁盘并还原受影响的数据。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-143">When a disk fails in an on-premises enterprise deployment, an administrator must manually replace the failed disk and restore the affected data.</span></span> <span data-ttu-id="7bf0a-144">在云部署中，Microsoft 365 的大小，让操作员 (云管理员手动更换) 既不实用也不经济可行。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-144">In a cloud deployment the size of Microsoft 365, having operators (cloud administrators) manually replacing disks is neither practical nor economically feasible.</span></span> 

<span data-ttu-id="7bf0a-145">自动重新设置子项（即 *AutoReseed）* 是一项功能，它代替了通常由操作员驱动的操作，以响应磁盘故障、数据库损坏事件或其他需要为数据库副本重新设置子级的问题。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-145">Automatic Reseed, or *AutoReseed*, is a feature that is the replacement for what is normally operator-driven action in response to a disk failure, database corruption event, or other issue that necessitates a reseeding of a database copy.</span></span> <span data-ttu-id="7bf0a-146">AutoReseed 旨在当磁盘故障发生后通过使用系统提供的备用磁盘自动还原数据库冗余。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-146">AutoReseed is designed to automatically restore database redundancy after a disk failure by using spare disks that have been provisioned on the system.</span></span> <span data-ttu-id="7bf0a-147">如果磁盘出现故障，则存储在该磁盘上的数据库副本将自动重新为服务器上预配置的备用磁盘重新设置子项，从而还原冗余。</span><span class="sxs-lookup"><span data-stu-id="7bf0a-147">If a disk fails, the database copies stored on that disk are automatically reseeded to a preconfigured spare disk on the server, thereby restoring redundancy.</span></span> 